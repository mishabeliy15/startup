{% load static %}
{% get_media_prefix as MEDIA_PREFIX %}
<!DOCTYPE html>
<html lang="en" dir="ltr">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>{{ object.title }}</title>
        <link rel="stylesheet" href="{% static 'style/null.css' %}">
        <link rel="stylesheet" href="{% static 'style/podcast.css' %}">
        <link rel="stylesheet" href="{% static 'style/media-podcast.css' %}">
        <link href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i&display=swap" rel="stylesheet">
        <script type="text/javascript">
            const CRSF_TOKEN = "{{ csrf_token }}";
            const USER_ID = {{ object.owner.id }};
            const PODCAST_ID = {{ object.id }};
        </script>
    </head>

    <body>
        <div class="blur-block-header">
            <div class="blur-blur"></div>
            <div class="blur-transparency white"></div>
            <div class="blur-conteiner podcast_header">
                <div class="podcast_block">
                    <div class="podcast_block_img">
                        <img class="podcast_block_img-img" src="{{ MEDIA_PREFIX }}{{ object.image }}" alt="podcast image">
                    </div>
                    <div class="podcast_block_info">
                        <div class="podcast_block_authot">
                            {{ object.author }}
                        </div>
                        <div id="rss">
                            RSS
                        </div>
                        <div class="podcast_block_name">
                            {{ object.title }}
                        </div>
                        <div class="podcast_block_episods">
                            {{ object.episodes.count }}
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="blur-block-content">
            <div class="blur-blur blur-blur-content"></div>
            <div class="blur-transparency black"></div>
            <div class="blur-conteiner content" id="content">
            </div>

            <footer>
                <address class="footer-text">
                    © 2019 Video2Cast.com
                    <nav>
                        <a href="{% url 'privacy_policy' %}">Privacy policy</a>
                    </nav>
                </address>
            </footer>


            <div class="window_remove display_none">
                <div class="window_remove_hidden-rss"></div>
                <div class="window_remove_content-rss">
                    <div class="window_remove_text">
                        Do you really want to delete this episode? This action cannot be undone!
                    </div>
                    <div class="window_remove_group_button">
                        <div class="window_remove_button_apply">
                            Delete
                        </div>
                        <div class="window_remove_button_cancel">
                            Cancel
                        </div>
                    </div>
                </div>
            </div>

            <div class="window_rss display_none">
                <div class="window_remove_hidden"></div>
                <div class="window_remove_content">
                    <div class="window_field-row">
                        <div class="window_title">
                            Podcast was created successfully!
                        </div>
                        <div class="btn_close">X</div>
                    </div>
                    <div class="window_field">
                        <div class="">
                            To index a podcast, first you must add an episode to the podcast:
                        </div>
                        <input class="btn_add_episods" type="button" name="add episode" value="Add episods!">
                    </div>
                    <div class="window_field">
                        <div class="">
                            This is your link to the RSS podcast:
                        </div>
                        <input class="rss_link" type="text" name="RSS link" value="LINK" readonly>
                    </div>
                    <div class="">
                        You can add your podcast to these services:
                    </div>
                    <div class="window_group_buttons">
                        <a class="btn-link" href="https://podcastsconnect.apple.com/my-podcasts" target="_blank">
                            <div class="apple-logo"></div>
                        </a>
                        <a class="btn-link" href="" target="_blank">
                            <div class="google-logo"></div>
                        </a>
                        <a class="btn-link" href="https://podcasters.spotify.com/submit" target="_blank">
                            <div class="spotify-logo"></div>
                        </a>
                    </div>
                </div>
            </div>
        </div>

            <!-- подключаем все скрипты -->
            <script src="{% static 'scripts/jquery-3.4.1.min.js' %}"></script>
            <script src="{% static 'scripts/main.js' %}"></script>
            <script type="text/javascript" src="{% static 'scripts/mypodcasts/apis.js' %}"></script>
            <script type="text/javascript">
                function drowEpisodEdit(item) {
                    return `
                        <div class="episode_content">
                            <div class="episode_content_title">
                                <input class="input-title" type="text" name="title" />
                                <div class="episode_content_liner"></div>
                            </div>
                            <textarea class="input-description" name="episod_more" rows="10" cols="80" value="">
                                Some brief informationSome brief informationSome brief informationSome brief informationSome brief informationSome brief informationSome brief informationSome brief informationSome brief informationSome brief informationSome brief informationSome brief informationSome brief informationSome brief informationSome brief informationSome brief informationSome brief informationSome brief informationSome brief informationSome brief informationSome brief informationSome brief informationSome brief informationSome brief informationSome brief informationSome brief informationSome brief informationSome brief informationSome brief informationSome brief informationSome brief information
                            </textarea>
                        </div>
                        <div class="episode_action_btn">
                            <div class="btn-confirm">

                            </div>
                            <div class="btn-cancel">

                            </div>
                            <div class="btn-delete">

                            </div>
                        </div>
                    `;
                }

                function play_episod() {
                    let contain = document.getElementById("content");
                    contain.innerHTML = ``;
                    for (let i = 0; i < 2; i++) {
                        contain.innerHTML += `
                            <div class="podcast_episode">
                                ${drowEpisodEdit()}
                            </div>
                        `;
                    }
                }

                function btn_edit() {
                    $('.btn-cancel').on('click', function(event) {
                        event.preventDefault();
                        index = $('.btn-cancel').index(this);
                        console.log(index);
                        episode_block = $('.podcast_episode');
                        console.log(episode_block);
                        episode_block[index].innerHTML = `${drowEpisodEdit()}`;
                        console.log(episode_block[index]);
                    });


                    $('.btn-confirm').on('click', function(event) {
                        event.preventDefault();
                        index = $('.btn-confirm').index(this);
                        description = $('.input-description')[index].value;
                        title = $('.input-title')[index].value;
                        if (description != '' && title != '') {
                            console.log(title, ' ', description);
                        } else {

                        }
                    });


                    $('.btn-delete').on('click', function(event) {
                        event.preventDefault();
                        $('.window_remove').toggleClass('display_none');
                        $('.window_remove').toggleClass('display_block');

                        btn_delete();
                    });

                    $("#rss").on('click', function(event) {
                        event.preventDefault();
                        $('.window_rss').toggleClass('display_none');
                        $('.window_rss').toggleClass('display_block');
                        console.log('0000000');
                    });


                    $('.rss_link').on('click', function(event) {
                        event.preventDefault();
                        console.log(1);
                        let rss_link = $('.rss_link')[0];
                        rss_link.select();
                        document.execCommand("copy");
                    });
                    $('.btn_close').on('click', function(event) {
                        event.preventDefault();
                        console.log(2);
                        $('.window_rss').toggleClass('display_none');
                        $('.window_rss').toggleClass('display_block');
                    });
                    $('.btn_add_episods').on('click', function(event) {
                        event.preventDefault();
                        console.log(3);
                        location.href = `/mypodcasts/add-episodes/?podcast=${CREATED_PODCAST.id}`;
                    });

                    $('.window_remove_button_apply').on('click', function(event) {
                        event.preventDefault();
                        //удалить подкаст из списка
                        location.reload();
                    });


                    $('.window_remove_button_cancel').on('click', function(event) {
                        event.preventDefault();
                        $('.window_remove').toggleClass('display_none');
                        $('.window_remove').toggleClass('display_block');
                    });
                }

                function btn_delete() {
                }


                function successfully_created() {
                    let content = document.getElementById("content");
                    console.log(content);
                    content.innerHTML = `
                        <div class="window_remove">
                            <div class="window_remove_hidden"></div>
                            <div class="window_remove_content">
                                <div class="window_field">
                                    <div class="window_title">
                                        Podcast was created successfully!
                                    </div>
                                    <div class="btn_close">X</div>
                                </div>
                                <div class="window_field">
                                    <div class="">
                                        To index a podcast, first you must add an episode to the podcast:
                                    </div>
                                    <input class="btn_add_episods" type="button" name="add episode" value="Add episods!">
                                </div>
                                <div class="window_field">
                                    <div class="">
                                        This is your link to the RSS podcast:
                                    </div>
                                    <input class="rss_link" type="text" name="RSS link" value="LINK" readonly>
                                </div>
                                <div class="">
                                    You can add your podcast to these services:
                                </div>
                                <div class="window_group_buttons">
                                    <a class="btn-link" href="https://podcastsconnect.apple.com/my-podcasts" target="_blank">
                                        <div class="apple-logo"></div>
                                    </a>
                                    <a class="btn-link" href="" target="_blank">
                                        <div class="google-logo"></div>
                                    </a>
                                    <a class="btn-link" href="https://podcasters.spotify.com/submit" target="_blank">
                                        <div class="spotify-logo"></div>
                                    </a>
                                </div>
                                <div class="">
                                    You can find these instructions on the podcast edit page.
                                </div>
                            </div>
                        </div>
                    `;
                }

                function whait_click_window() {
                }

                play_episod();
                btn_edit();
            </script>
    </body>

</html>
